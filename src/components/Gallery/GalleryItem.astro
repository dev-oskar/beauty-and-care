---
interface Props {
  image: {
    src: string | any;
    caption?: string;
    alt?: string;
    category?: string;
    galleryTitle?: string;
    galleryDescription?: string;
  };
  index: number;
}

const { image, index } = Astro.props;

// Extract image source properly - handles both string paths and imported image objects
const imageSrc = typeof image.src === 'string' ? image.src : image.src.src;
---

<div 
  class="gallery-item overflow-hidden rounded-lg shadow-md transition-all duration-300 hover:shadow-lg" 
  data-category={image.category || "uncategorized"}
  data-index={index}
>
  <div class="relative group cursor-pointer overflow-hidden aspect-square">
    <img 
      src={imageSrc}
      alt={image.alt || "Gallery image"} 
      width="400" 
      height="400"
      loading="lazy"
      class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
    />
    <div class="absolute inset-0 bg-black opacity-0 group-hover:opacity-30 transition-all duration-300 flex items-center justify-center">
      <div class="transform translate-y-10 opacity-0 group-hover:translate-y-0 group-hover:opacity-100 transition-all duration-300">
        <span class="text-white bg-gray-800 rounded-full w-12 h-12 flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </span>
      </div>
    </div>
  </div>
  <div class="p-4 bg-white">
    {image.caption && (
      <p class="text-gray-800 font-medium line-clamp-2">{image.caption}</p>
    )}
    
    {image.category && (
      <span class="text-xs text-gray-600 mt-1 inline-block px-2 py-0.5 bg-gray-100 rounded-full">
        {image.category}
      </span>
    )}
    
    {image.galleryTitle && !image.caption && (
      <p class="text-gray-800 font-medium line-clamp-1">{image.galleryTitle}</p>
    )}
  </div>
</div>